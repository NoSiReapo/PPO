**Дата:** 23 декабря 2023 г.

**Статус:**  

**Контекст:** 

При разработке платформы для мониторинга, анализа и отчетности по потреблению электроэнергии в домах и промышленных объектах мы стоим перед выбором системы мониторинга для нашего продукта. От этого выбора зависит удобство сбора данных и простота интеграции системы мониторинга.

**Рассмотренные варианты:**

1. **Prometheus** - представляет собой комплексное решение, в состав которого входят и фреймворк для мониторинга, и собственная темпоральная база данных.
2. **Zabbix** - одна из наиболее распространённых систем мониторинга ИТ-инфраструктуры. Её применяют для выявления и предотвращения потенциальных проблем с оборудованием или в работе сайта, домена приложений. Ключевыми преимуществами программы считаются открытый исходный код, а также совместимость с несколькими видами операционных систем. 
3. **Icinga** - представляет из себя модульную систему мониторинга с открытым исходным кодом, изначально созданная как ответвление от Nagios. Позволяет наблюдать за состоянием серверной инфраструктуры, сервисов, роутеров и т.д. Icinga 2 предлагает как прямой мониторинг, так и поддержку SNMP для серверов и других устройств. Ее используют для снятия метрик и алертов по хостам и их сервисам.

**Решение:**

Prometheus.

**Обоснование:**

1. Более гибок. Prometheus предоставляет собственный язык для запросов, который называется **PromQL**. Он может применять функции и операторы к запросам метрик, фильтровать, группировать по меткам и использовать регулярные выражения для улучшения сопоставления и фильтрации. Результат выражения можно отобразить в виде графика, просмотреть в виде табличных данных в браузере или использовать внешние системы через HTTP API.
2. Prometheus хранит данные в виде time-series database. Имея локальную БД, он может получать и обрабатывать больше метрик, чем другие системы.
3. Самый комплексный инструмент, что расширяет наш обзор мониторинга и сбора статистики


**Последствия:**

1. Понадобится правильная установка и интеграция Prometheus.
2. Желательно использовать совместно с **Grafana**. 
3. Для логов придется использовать отдельный инструмент (Prometheus не подходит для текста, журналов или журналов событий.).
4.  Необходимо установить Alertmanager (Это связано с тем, что оповещение с помощью Prometheus разделено на две части. Правила оповещения пересылают оповещения менеджеру. Затем он отправляет уведомления по электронной почте или другим платформам.). 